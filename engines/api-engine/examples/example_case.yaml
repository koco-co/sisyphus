# ==============================================================================
# 适用引擎: api-engine
# 描述: 示例测试用例 - 演示 HTTP 请求和断言
# ==============================================================================
URL: http://shop-xo.hctestedu.com 
DSWURL: http://novel.hctestedu.com 


config:
  name: "API 功能测试示例"
  base_url: "https://httpbin.org"
  timeout: 30
  retries: 0
  variables:
    test_user: "sisyphus"
    test_value: "hello_world"
  _database:
    mysql001: #多个地方都会引用到这个数据
      host: shop-xo.hctestedu.com 
      port: 3306
      user: api_test 
      password: Aa9999!
      db: shopxo_hctested 
    
    mysql002:
      host: shop-xo.hctestedu.com 
      port: 3306
      user: api_test 
      password: Aa9999!
      db: novel-plus

teststeps:
  - name: "GET 请求测试"
    id: "step_01"
    type: "api"
    request:
      method: "GET"
      url: "/get"
      params:
        user: "${test_user}"
        value: "${test_value}"
    extract:
      request_url: "body.url"
    validate:
      - eq: ["status_code", 200]
      - contains: ["body.url", "httpbin.org"]

  - name: "等待 500ms"
    id: "step_02"
    type: "wait"
    duration_ms: 500

  - name: "POST JSON 请求测试"
    id: "step_03"
    type: "api"
    request:
      method: "POST"
      url: "/post"
      headers:
        Content-Type: "application/json"
        X-Custom-Header: "SisyphusX-Test"
      json:
        username: "${test_user}"
        message: "测试消息"
        timestamp: 1706097600
    validate:
      - eq: ["status_code", 200]
      - eq: ["body.json.username", "${test_user}"]
